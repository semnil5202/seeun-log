---
/** 모바일 전용 헤더. PC 헤더와 동일한 디자인으로 카테고리 top-level만 표시한다. */

import { getCategoryTree } from "@/shared/lib/i18n/categories";
import { getLocalePath } from "@/shared/lib/i18n/locales";
import { t } from "@/shared/lib/i18n/translations";
import { DEFAULT_LOCALE } from "@/shared/types/common";
import type { Locale } from "@/shared/types/common";
import { CATEGORY_SLUGS, type CategorySlug } from "@/shared/types/category";

interface Props {
  locale: Locale;
}

const { locale } = Astro.props;

const categories = getCategoryTree(locale);
const homeHref = getLocalePath("/", locale);

const segments = Astro.url.pathname.split("/").filter(Boolean);
if (locale !== DEFAULT_LOCALE && segments[0] === locale) segments.shift();
const activeCategory: CategorySlug | null =
  CATEGORY_SLUGS.includes(segments[0] as CategorySlug) ? (segments[0] as CategorySlug) : null;
---

<header class="w-full bg-white border-b border-gray-200">
  <div class="flex items-center h-14 px-4 gap-4">

    <a
      href={homeHref}
      class="shrink-0 text-title2 font-bold text-primary-600 tracking-tight hover:text-primary-700 transition-colors duration-150"
      aria-label="세은로그 홈으로 이동"
    >
      세은로그
    </a>

    <nav aria-label="Main navigation" class="flex items-center gap-1">
      {
        categories.map((category, index) => (
          <>
            <a
              href={getLocalePath(`/${category.slug}/`, locale)}
              class:list={[
                "px-2.5 py-1.5 text-body2 font-semibold transition-colors duration-150 rounded-md hover:bg-primary-50",
                activeCategory === category.slug
                  ? "text-primary-600"
                  : "text-gray-700 hover:text-primary-500",
              ]}
              aria-current={activeCategory === category.slug ? "true" : undefined}
            >
              {category.label}
            </a>
            {index < categories.length - 1 && (
              <span class="text-gray-300 select-none" aria-hidden="true">|</span>
            )}
          </>
        ))
      }
    </nav>

    <div class="ml-auto shrink-0 flex items-center gap-2">

      <a
        href={getLocalePath("/", locale)}
        class="flex items-center justify-center w-8 h-8 text-gray-600 hover:text-primary-500 transition-colors duration-150 rounded-md"
        aria-label={t("nav.language", locale)}
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="w-5 h-5"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          aria-hidden="true"
        >
          <circle cx="12" cy="12" r="10" />
          <line x1="2" y1="12" x2="22" y2="12" />
          <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z" />
        </svg>
      </a>

      <a
        href={getLocalePath("/search/", locale)}
        class="flex items-center justify-center w-8 h-8 text-gray-600 hover:text-primary-500 transition-colors duration-150 rounded-md"
        aria-label={t("nav.search", locale)}
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="w-5 h-5"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          aria-hidden="true"
        >
          <circle cx="11" cy="11" r="8" />
          <line x1="21" y1="21" x2="16.65" y2="16.65" />
        </svg>
      </a>

    </div>
  </div>
</header>
